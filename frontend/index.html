<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>CRUD Items</title>
    <style>
      input {
        margin: 5px;
      }
      button {
        margin: 5px;
      }
      li {
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <h1>CRUD Items</h1>

    <div>
      <h3>Create Item</h3>
      <input id="name" placeholder="Item name" />
      <input id="quantity" type="number" placeholder="Quantity" />
      <button onclick="createItem()">Create</button>
    </div>

    <div>
      <h3>All Items</h3>
      <ul id="itemsList"></ul>
    </div>

    <script>
      const API_URL = "http://localhost:3000/api/items";

      async function fetchItems() {
        const res = await fetch(API_URL);
        const items = await res.json();
        const list = document.getElementById("itemsList");
        list.innerHTML = "";
        items.forEach((item) => {
          const li = document.createElement("li");
          li.textContent = `ID:${item.id} Name:${item.name} Quantity:${item.quantity}`;

          const editBtn = document.createElement("button");
          editBtn.textContent = "Edit";
          editBtn.onclick = () => editItem(item);

          const delBtn = document.createElement("button");
          delBtn.textContent = "Delete";
          delBtn.onclick = () => deleteItem(item.id);

          li.appendChild(editBtn);
          li.appendChild(delBtn);
          list.appendChild(li);
        });
      }

      async function createItem() {
        const name = document.getElementById("name").value;
        const quantity = Number(document.getElementById("quantity").value);

        if (!name || quantity == null)
          return alert("Name and quantity are required");

        await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, quantity }),
        });
        fetchItems();
      }

      async function editItem(item) {
        const name = prompt("New name:", item.name);
        const quantity = prompt("New quantity:", item.quantity);
        if (!name || quantity == null) return;

        await fetch(`${API_URL}/${item.id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, quantity: Number(quantity) }),
        });
        fetchItems();
      }

      async function deleteItem(id) {
        await fetch(`${API_URL}/${id}`, { method: "DELETE" });
        fetchItems();
      }

      fetchItems();
    </script>
  </body>
</html>
